{"version":3,"sources":["hooks/useSessionStorage.js","../node_modules/_bistate@1.0.0@bistate/dist/lib/index.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","demos/TodoApp.js"],"names":["__webpack_require__","d","__webpack_exports__","useSessionStorage","react__WEBPACK_IMPORTED_MODULE_0__","_ref","key","getter","setter","ref","useRef","useEffect","json","window","sessionStorage","getItem","current","JSON","parse","saveToStorage","value","stringify","setItem","addEventListener","removeEventListener","__importDefault","this","mod","__esModule","default","Object","defineProperty","exports","createBistate_1","mutate","remove","isBistate","createStore_1","createStore","_objectWithoutProperties","source","excluded","i","target","sourceKeys","keys","length","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","initialState","todos","text","type","App","state","useBistate","sync","useMutate","assign","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","Fragment","Header","Todos","Footer","handleChange","event","handleKeyUp","handleAddTodo","handleToggleAll","hasActiveItem","some","todo","completed","forEach","alert","push","id","Date","now","content","TodoInput","onKeyUp","onClick","onChange","_ref2","list","filter","map","Todo","_ref3","edit","handleEdit","handleEdited","handleRemove","handleToggle","onBlur","_ref4","props","D_Users_Jade_Documents_code_github_bistate_examples_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","_ref5","activeItems","completedItems","handleClearCompleted","item"],"mappings":"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","file":"static/js/4.e358524d.chunk.js","sourcesContent":["import { useRef, useEffect } from 'react'\r\n\r\nexport default function useSessionStorage({ key, getter, setter }) {\r\n  let ref = useRef({ key, getter, setter })\r\n\r\n  useEffect(() => {\r\n    let json = window.sessionStorage.getItem(key)\r\n\r\n    if (json) {\r\n      ref.current.setter(JSON.parse(json))\r\n    }\r\n\r\n    let saveToStorage = () => {\r\n      let value = JSON.stringify(ref.current.getter())\r\n      window.sessionStorage.setItem(key, value)\r\n    }\r\n\r\n    window.addEventListener('beforeunload', saveToStorage, false)\r\n\r\n    return () => {\r\n      saveToStorage()\r\n      window.removeEventListener('beforeunload', saveToStorage, false)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    ref.current = { key, getter, setter }\r\n  }, [key, getter, setter])\r\n}\r\n","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar createBistate_1 = require(\"./createBistate\");\n\nexports.mutate = createBistate_1.mutate;\nexports.remove = createBistate_1.remove;\nexports.isBistate = createBistate_1.isBistate;\n\nvar createStore_1 = __importDefault(require(\"./createStore\"));\n\nexports.createStore = createStore_1.default;","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import React from 'react'\r\nimport { remove } from 'bistate'\r\nimport { useBistate, useMutate } from 'bistate/react'\r\nimport useSessionStorage from '../hooks/useSessionStorage'\r\n\r\nconst initialState = {\r\n  todos: [],\r\n  text: {\r\n    value: ''\r\n  },\r\n  type: {\r\n    value: 'all'\r\n  }\r\n}\r\n\r\nexport default function App() {\r\n  let state = useBistate(initialState)\r\n\r\n  let sync = useMutate(source => {\r\n    Object.assign(state, source)\r\n  })\r\n\r\n  useSessionStorage({\r\n    key: 'todos-json',\r\n    getter: () => state,\r\n    setter: sync\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <Header type={state.type} text={state.text} todos={state.todos} />\r\n      <Todos todos={state.todos} type={state.type} />\r\n      <Footer todos={state.todos} />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Header({ text, todos, type }) {\r\n  let handleChange = useMutate(event => {\r\n    type.value = event.target.value\r\n  })\r\n\r\n  let handleKeyUp = useMutate(event => {\r\n    if (event.key === 'Enter') {\r\n      handleAddTodo()\r\n    }\r\n  })\r\n\r\n  let handleToggleAll = useMutate(() => {\r\n    let hasActiveItem = todos.some(todo => !todo.completed)\r\n\r\n    todos.forEach(todo => {\r\n      todo.completed = hasActiveItem\r\n    })\r\n  })\r\n\r\n  let handleAddTodo = useMutate(() => {\r\n    if (!text.value) {\r\n      return alert('empty content')\r\n    }\r\n\r\n    todos.push({\r\n      id: Date.now(),\r\n      content: text.value,\r\n      completed: false\r\n    })\r\n\r\n    text.value = ''\r\n  })\r\n\r\n  return (\r\n    <div>\r\n      <TodoInput text={text} onKeyUp={handleKeyUp} />\r\n      <button onClick={handleAddTodo}>add</button>\r\n      <button onClick={handleToggleAll}>toggle-all</button>\r\n      <select value={type.value} onChange={handleChange}>\r\n        <option value=\"all\">all</option>\r\n        <option value=\"active\">active</option>\r\n        <option value=\"completed\">completed</option>\r\n      </select>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction Todos({ todos, type }) {\r\n  let list = todos.filter(todo => {\r\n    if (type.value === 'all') return true\r\n    if (type.value === 'active') return !todo.completed\r\n    if (type.value === 'completed') return todo.completed\r\n    return false\r\n  })\r\n\r\n  return (\r\n    <ul>\r\n      {list.map(todo => {\r\n        return <Todo key={todo.id} todo={todo} />\r\n      })}\r\n    </ul>\r\n  )\r\n}\r\n\r\nfunction Todo({ todo }) {\r\n  let edit = useBistate({ value: false })\r\n  let text = useBistate({ value: '' })\r\n\r\n  let handleEdit = useMutate(() => {\r\n    edit.value = !edit.value\r\n    text.value = todo.content\r\n  })\r\n\r\n  let handleEdited = useMutate(() => {\r\n    edit.value = false\r\n    if (text.value === '') {\r\n      remove(todo)\r\n    } else {\r\n      todo.content = text.value\r\n    }\r\n  })\r\n\r\n  let handleKeyUp = useMutate(event => {\r\n    if (event.key === 'Enter') {\r\n      handleEdited()\r\n    }\r\n  })\r\n\r\n  let handleRemove = useMutate(() => {\r\n    remove(todo)\r\n  })\r\n\r\n  let handleToggle = useMutate(() => {\r\n    todo.completed = !todo.completed\r\n  })\r\n\r\n  return (\r\n    <li>\r\n      <button onClick={handleRemove}>remove</button>\r\n      <button onClick={handleToggle}>\r\n        {todo.completed ? 'completed' : 'active'}\r\n      </button>\r\n      {edit.value && (\r\n        <TodoInput text={text} onBlur={handleEdited} onKeyUp={handleKeyUp} />\r\n      )}\r\n      {!edit.value && <span onClick={handleEdit}>{todo.content}</span>}\r\n    </li>\r\n  )\r\n}\r\n\r\nfunction TodoInput({ text, ...props }) {\r\n  let handleChange = useMutate(event => {\r\n    text.value = event.target.value\r\n  })\r\n  return (\r\n    <input type=\"text\" {...props} onChange={handleChange} value={text.value} />\r\n  )\r\n}\r\n\r\nfunction Footer({ todos }) {\r\n  let activeItems = todos.filter(todo => !todo.completed)\r\n  let completedItems = todos.filter(todo => todo.completed)\r\n\r\n  let handleClearCompleted = useMutate(() => {\r\n    completedItems.forEach(item => remove(item))\r\n  })\r\n\r\n  if (todos.length === 0) return null\r\n\r\n  return (\r\n    <div>\r\n      {activeItems.length} item{activeItems.length > 1 && 's'} left\r\n      {completedItems.length > 0 && (\r\n        <>\r\n          {' | '}\r\n          <button onClick={handleClearCompleted}>Clear completed</button>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"sourceRoot":""}