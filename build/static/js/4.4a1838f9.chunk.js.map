{"version":3,"sources":["hooks/useSessionStorage.js","../../../src/index.ts","../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","demos/TodoApp.js"],"names":["__webpack_require__","d","__webpack_exports__","useSessionStorage","react__WEBPACK_IMPORTED_MODULE_0__","_ref","key","getter","setter","ref","useRef","useEffect","json","window","sessionStorage","getItem","current","JSON","parse","value","stringify","setItem","createBistate_1","exports","mutate","remove","isBistate","createStore_1","__importDefault","createStore","default","_objectWithoutProperties","source","excluded","i","target","sourceKeys","Object","keys","length","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","App","_useBistate","useBistate","todos","text","state","D_Users_yj_gu_Documents_code_GitHub_bistate_examples_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","sync","useMutate","assign","handleAddTodo","alert","push","id","Date","now","content","completed","handleKeyUp","event","handleToggleAll","hasActiveItem","some","todo","forEach","react__WEBPACK_IMPORTED_MODULE_2___default","a","createElement","Fragment","TodoInput","onKeyUp","onClick","Todos","Footer","map","Todo","_ref2","_useBistate3","edit","_useBistate5","handleEdit","handleEdited","handleRemove","handleToggle","onBlur","_ref3","props","D_Users_yj_gu_Documents_code_GitHub_bistate_examples_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","handleChange","type","onChange","_ref4","activeItems","filter","completedItems","handleClearCompleted","item"],"mappings":"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","file":"static/js/4.4a1838f9.chunk.js","sourcesContent":["import { useRef, useEffect } from 'react'\r\n\r\nexport default function useSessionStorage({ key, getter, setter }) {\r\n  let ref = useRef({ key, getter, setter })\r\n\r\n  useEffect(() => {\r\n    let json = window.sessionStorage.getItem(key)\r\n\r\n    if (json) {\r\n      ref.current.setter(JSON.parse(json))\r\n    }\r\n\r\n    return () => {\r\n      let value = JSON.stringify(ref.current.getter())\r\n      window.sessionStorage.setItem(key, value)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    ref.current = { key, getter, setter }\r\n  }, [key, getter, setter])\r\n}\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar createBistate_1 = require(\"./createBistate\");\r\nexports.mutate = createBistate_1.mutate;\r\nexports.remove = createBistate_1.remove;\r\nexports.isBistate = createBistate_1.isBistate;\r\nvar createStore_1 = __importDefault(require(\"./createStore\"));\r\nexports.createStore = createStore_1.default;\r\n//# sourceMappingURL=index.js.map","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import React from 'react'\r\nimport { remove } from 'bistate'\r\nimport { useBistate, useMutate } from 'bistate/react'\r\nimport useSessionStorage from '../hooks/useSessionStorage'\r\n\r\nexport default function App() {\r\n  let [state] = useBistate({\r\n    todos: [],\r\n    text: {\r\n      value: ''\r\n    }\r\n  })\r\n\r\n  let sync = useMutate(source => {\r\n    Object.assign(state, source)\r\n  })\r\n\r\n  useSessionStorage({\r\n    key: 'todos-json',\r\n    getter: () => state,\r\n    setter: sync\r\n  })\r\n\r\n  let handleAddTodo = useMutate(() => {\r\n    if (!state.text.value) {\r\n      return alert('empty content')\r\n    }\r\n\r\n    state.todos.push({\r\n      id: Date.now(),\r\n      content: state.text.value,\r\n      completed: false\r\n    })\r\n\r\n    state.text.value = ''\r\n  })\r\n\r\n  let handleKeyUp = useMutate(event => {\r\n    if (event.key === 'Enter') {\r\n      handleAddTodo()\r\n    }\r\n  })\r\n\r\n  let handleToggleAll = useMutate(() => {\r\n    let hasActiveItem = state.todos.some(todo => !todo.completed)\r\n\r\n    state.todos.forEach(todo => {\r\n      todo.completed = hasActiveItem\r\n    })\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <div>\r\n        <TodoInput text={state.text} onKeyUp={handleKeyUp} />\r\n        <button onClick={handleAddTodo}>add</button>\r\n        <button onClick={handleToggleAll}>toggle-all</button>\r\n      </div>\r\n      <Todos todos={state.todos} />\r\n      <Footer todos={state.todos} />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Todos({ todos }) {\r\n  return (\r\n    <ul>\r\n      {todos.map(todo => {\r\n        return <Todo key={todo.id} todo={todo} />\r\n      })}\r\n    </ul>\r\n  )\r\n}\r\n\r\nfunction Todo({ todo }) {\r\n  let [edit] = useBistate({ value: false })\r\n  let [text] = useBistate({ value: '' })\r\n\r\n  let handleEdit = useMutate(() => {\r\n    edit.value = !edit.value\r\n    text.value = todo.content\r\n  })\r\n\r\n  let handleEdited = useMutate(() => {\r\n    edit.value = false\r\n    if (text.value === '') {\r\n      remove(todo)\r\n    } else {\r\n      todo.content = text.value\r\n    }\r\n  })\r\n\r\n  let handleKeyUp = useMutate(event => {\r\n    if (event.key === 'Enter') {\r\n      handleEdited()\r\n    }\r\n  })\r\n\r\n  let handleRemove = useMutate(() => {\r\n    remove(todo)\r\n  })\r\n\r\n  let handleToggle = useMutate(() => {\r\n    todo.completed = !todo.completed\r\n  })\r\n\r\n  return (\r\n    <li>\r\n      <button onClick={handleRemove}>remove</button>\r\n      <button onClick={handleToggle}>\r\n        {todo.completed ? 'completed' : 'active'}\r\n      </button>\r\n      {edit.value && (\r\n        <TodoInput text={text} onBlur={handleEdited} onKeyUp={handleKeyUp} />\r\n      )}\r\n      {!edit.value && <span onClick={handleEdit}>{todo.content}</span>}\r\n    </li>\r\n  )\r\n}\r\n\r\nfunction TodoInput({ text, ...props }) {\r\n  let handleChange = useMutate(event => {\r\n    text.value = event.target.value\r\n  })\r\n  return (\r\n    <input type=\"text\" {...props} onChange={handleChange} value={text.value} />\r\n  )\r\n}\r\n\r\nfunction Footer({ todos }) {\r\n  let activeItems = todos.filter(todo => !todo.completed)\r\n  let completedItems = todos.filter(todo => todo.completed)\r\n\r\n  let handleClearCompleted = useMutate(() => {\r\n    completedItems.forEach(item => remove(item))\r\n  })\r\n\r\n  return (\r\n    <div>\r\n      {activeItems.length} item{activeItems.length > 1 && 's'} left |{' '}\r\n      {completedItems.length > 0 && (\r\n        <button onClick={handleClearCompleted}>Clear completed</button>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"sourceRoot":""}