{"version":3,"sources":["hooks/useSessionStorage.js","../node_modules/_bistate@1.0.0@bistate/dist/lib/index.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/_@babel_runtime@7.5.5@@babel/runtime/helpers/esm/nonIterableRest.js","demos/Reducer-TodoApp.js"],"names":["__webpack_require__","d","__webpack_exports__","useSessionStorage","react__WEBPACK_IMPORTED_MODULE_0__","_ref","key","getter","setter","ref","useRef","useEffect","json","window","sessionStorage","getItem","current","JSON","parse","saveToStorage","value","stringify","setItem","addEventListener","removeEventListener","__importDefault","this","mod","__esModule","default","Object","defineProperty","exports","createBistate_1","mutate","remove","isBistate","createStore_1","createStore","_objectWithoutProperties","source","excluded","i","target","sourceKeys","keys","length","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","_slicedToArray","arr","Array","isArray","_arrayWithHoles","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","_iterableToArrayLimit","TypeError","_nonIterableRest","App","_useBireducer2","useBireducer","state","action","type","todo","id","Date","now","content","text","completed","todos","hasActiveItem","some","forEach","assign","payload","dispatch","handleAddTodo","alert","_react_16_9_0_react_default","a","createElement","Fragment","TodoInput","onKeyUp","event","onClick","Todos","Footer","map","Todo","_ref2","_useBireducer4","edit","handleEdited","onBlur","_ref3","props","objectWithoutProperties","handleChange","useMutate","onChange","_ref4","activeItems","filter","completedItems","handleClearCompleted","item"],"mappings":"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","file":"static/js/3.a4f2393f.chunk.js","sourcesContent":["import { useRef, useEffect } from 'react'\r\n\r\nexport default function useSessionStorage({ key, getter, setter }) {\r\n  let ref = useRef({ key, getter, setter })\r\n\r\n  useEffect(() => {\r\n    let json = window.sessionStorage.getItem(key)\r\n\r\n    if (json) {\r\n      ref.current.setter(JSON.parse(json))\r\n    }\r\n\r\n    let saveToStorage = () => {\r\n      let value = JSON.stringify(ref.current.getter())\r\n      window.sessionStorage.setItem(key, value)\r\n    }\r\n\r\n    window.addEventListener('beforeunload', saveToStorage, false)\r\n\r\n    return () => {\r\n      saveToStorage()\r\n      window.removeEventListener('beforeunload', saveToStorage, false)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    ref.current = { key, getter, setter }\r\n  }, [key, getter, setter])\r\n}\r\n","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar createBistate_1 = require(\"./createBistate\");\n\nexports.mutate = createBistate_1.mutate;\nexports.remove = createBistate_1.remove;\nexports.isBistate = createBistate_1.isBistate;\n\nvar createStore_1 = __importDefault(require(\"./createStore\"));\n\nexports.createStore = createStore_1.default;","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","import React from 'react'\r\nimport { remove } from 'bistate'\r\nimport { useBireducer, useMutate } from 'bistate/react'\r\nimport useSessionStorage from '../hooks/useSessionStorage'\r\n\r\nexport default function App() {\r\n  let initialState = {\r\n    todos: [],\r\n    text: {\r\n      value: ''\r\n    }\r\n  }\r\n  let [state, dispatch] = useBireducer((state, action) => {\r\n    if (action.type === 'ADD_TODO') {\r\n      let todo = {\r\n        id: Date.now(),\r\n        content: state.text.value,\r\n        completed: false\r\n      }\r\n      state.todos.push(todo)\r\n      state.text.value = ''\r\n    }\r\n\r\n    if (action.type === 'TOGGLE_ALL') {\r\n      let hasActiveItem = state.todos.some(todo => !todo.completed)\r\n\r\n      state.todos.forEach(todo => {\r\n        todo.completed = hasActiveItem\r\n      })\r\n    }\r\n\r\n    if (action.type === 'SYNC_STORAGE') {\r\n      Object.assign(state, action.payload)\r\n    }\r\n  }, initialState)\r\n\r\n  useSessionStorage({\r\n    key: 'reducer-todos-json',\r\n    getter: () => state,\r\n    setter: source => dispatch({ type: 'SYNC_STORAGE', payload: source })\r\n  })\r\n\r\n  let handleAddTodo = () => {\r\n    if (!state.text.value) {\r\n      return alert('empty content')\r\n    }\r\n    dispatch({ type: 'ADD_TODO' })\r\n  }\r\n\r\n  let handleToggleAll = () => {\r\n    dispatch({ type: 'TOGGLE_ALL' })\r\n  }\r\n\r\n  let handleKeyUp = event => {\r\n    if (event.key === 'Enter') {\r\n      handleAddTodo()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div>\r\n        <TodoInput text={state.text} onKeyUp={handleKeyUp} />\r\n        <button onClick={handleAddTodo}>add</button>\r\n        <button onClick={handleToggleAll}>toggle-all</button>\r\n      </div>\r\n      <Todos todos={state.todos} />\r\n      <Footer todos={state.todos} />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Todos({ todos }) {\r\n  return (\r\n    <ul>\r\n      {todos.map(todo => {\r\n        return <Todo key={todo.id} todo={todo} />\r\n      })}\r\n    </ul>\r\n  )\r\n}\r\n\r\nfunction Todo({ todo }) {\r\n  let [state, dispatch] = useBireducer(\r\n    (state, action) => {\r\n      if (action.type === 'EDIT') {\r\n        state.edit.value = true\r\n        state.text.value = todo.content\r\n      }\r\n\r\n      if (action.type === 'EDITED') {\r\n        if (state.text.value === '') {\r\n          remove(todo)\r\n        } else {\r\n          state.edit.value = false\r\n          todo.content = state.text.value\r\n        }\r\n      }\r\n\r\n      if (action.type === 'REMOVE') {\r\n        remove(todo)\r\n      }\r\n\r\n      if (action.type === 'TOGGLE') {\r\n        todo.completed = !todo.completed\r\n      }\r\n    },\r\n    {\r\n      edit: {\r\n        value: false\r\n      },\r\n      text: {\r\n        value: ''\r\n      }\r\n    }\r\n  )\r\n\r\n  let handleEdit = () => {\r\n    dispatch({ type: 'EDIT' })\r\n  }\r\n\r\n  let handleEdited = () => {\r\n    dispatch({ type: 'EDITED' })\r\n  }\r\n\r\n  let handleKeyUp = event => {\r\n    if (event.key === 'Enter') {\r\n      handleEdited()\r\n    }\r\n  }\r\n\r\n  let handleRemove = () => {\r\n    dispatch({ type: 'REMOVE' })\r\n  }\r\n\r\n  let handleToggle = () => {\r\n    dispatch({ type: 'TOGGLE' })\r\n  }\r\n\r\n  return (\r\n    <li>\r\n      <button onClick={handleRemove}>remove</button>\r\n      <button onClick={handleToggle}>\r\n        {todo.completed ? 'completed' : 'active'}\r\n      </button>\r\n      {state.edit.value && (\r\n        <TodoInput\r\n          text={state.text}\r\n          onBlur={handleEdited}\r\n          onKeyUp={handleKeyUp}\r\n        />\r\n      )}\r\n      {!state.edit.value && <span onClick={handleEdit}>{todo.content}</span>}\r\n    </li>\r\n  )\r\n}\r\n\r\nfunction TodoInput({ text, ...props }) {\r\n  let handleChange = useMutate(event => {\r\n    text.value = event.target.value\r\n  })\r\n  return (\r\n    <input type=\"text\" {...props} onChange={handleChange} value={text.value} />\r\n  )\r\n}\r\n\r\nfunction Footer({ todos }) {\r\n  let activeItems = todos.filter(todo => !todo.completed)\r\n  let completedItems = todos.filter(todo => todo.completed)\r\n\r\n  let handleClearCompleted = useMutate(() => {\r\n    todos.filter(todo => todo.completed).forEach(item => remove(item))\r\n  })\r\n\r\n  return (\r\n    <div>\r\n      {activeItems.length} item{activeItems.length > 1 && 's'} left |{' '}\r\n      {completedItems.length > 0 && (\r\n        <button onClick={handleClearCompleted}>Clear completed</button>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"sourceRoot":""}